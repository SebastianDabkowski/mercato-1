@page
@model Mercato.Web.Pages.Seller.Onboarding.CompleteModel
@{
    ViewData["Title"] = "Complete - Seller Onboarding";
}

<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            @if (Model.Onboarding?.Status == Mercato.Seller.Domain.Entities.OnboardingStatus.PendingVerification ||
                 Model.Onboarding?.Status == Mercato.Seller.Domain.Entities.OnboardingStatus.Verified)
            {
                <!-- Success State -->
                <div class="text-center py-5">
                    <div class="mb-4">
                        <i class="bi bi-check-circle-fill text-success" style="font-size: 5rem;"></i>
                    </div>
                    
                    @if (Model.JustCompleted)
                    {
                        <h2 class="mb-3">Congratulations! ðŸŽ‰</h2>
                        <p class="lead text-muted mb-4">
                            Your seller account has been successfully created and is now pending verification.
                        </p>
                    }
                    else
                    {
                        <h2 class="mb-3">Onboarding Complete</h2>
                        <p class="lead text-muted mb-4">
                            Your seller account is
                            @if (Model.Onboarding?.Status == Mercato.Seller.Domain.Entities.OnboardingStatus.Verified)
                            {
                                <span class="text-success">verified and active</span>
                            }
                            else
                            {
                                <span>pending verification</span>
                            }
                        </p>
                    }

                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <h5 class="card-title mb-3">What's Next?</h5>
                            
                            @if (Model.Onboarding?.Status == Mercato.Seller.Domain.Entities.OnboardingStatus.PendingVerification)
                            {
                                <div class="alert alert-info" role="alert">
                                    <i class="bi bi-hourglass-split me-2"></i>
                                    <strong>Verification in Progress</strong>
                                    <p class="mb-0 mt-2">Our team will review your information. This typically takes 1-3 business days. You'll receive an email notification once your account is verified.</p>
                                </div>
                                
                                <p class="text-muted">While you wait, you can:</p>
                                <ul class="list-unstyled">
                                    <li class="mb-2">
                                        <i class="bi bi-check2 text-primary me-2"></i>Review your seller dashboard
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-check2 text-primary me-2"></i>Submit KYC documents for faster verification
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-check2 text-primary me-2"></i>Prepare your product listings
                                    </li>
                                </ul>
                            }
                            else
                            {
                                <p class="text-muted">Your account is verified! You can now:</p>
                                <ul class="list-unstyled">
                                    <li class="mb-2">
                                        <i class="bi bi-check2 text-success me-2"></i>List products for sale
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-check2 text-success me-2"></i>Manage your store
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-check2 text-success me-2"></i>Track orders and sales
                                    </li>
                                </ul>
                            }
                        </div>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                        <a asp-page="/Seller/Index" class="btn btn-primary btn-lg">
                            <i class="bi bi-speedometer2 me-1"></i>Go to Dashboard
                        </a>
                        <a asp-page="/Seller/Kyc/Submit" class="btn btn-outline-primary btn-lg">
                            <i class="bi bi-upload me-1"></i>Submit KYC Documents
                        </a>
                    </div>
                </div>
            }
            else
            {
                <!-- Review and Submit State -->
                <div class="mb-4">
                    <div class="d-flex justify-content-between mb-2">
                        <span class="text-muted">Final Step</span>
                        <span class="text-muted">100% Complete</span>
                    </div>
                    <div class="progress" style="height: 8px;">
                        <div class="progress-bar bg-success" role="progressbar" style="width: 100%"></div>
                    </div>
                </div>

                <nav class="mb-4">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">
                            <a asp-page="StoreProfile"><i class="bi bi-check-circle-fill text-success me-1"></i>Store Profile</a>
                        </li>
                        <li class="breadcrumb-item">
                            <a asp-page="VerificationData"><i class="bi bi-check-circle-fill text-success me-1"></i>Verification</a>
                        </li>
                        <li class="breadcrumb-item">
                            <a asp-page="PayoutBasics"><i class="bi bi-check-circle-fill text-success me-1"></i>Payout</a>
                        </li>
                        <li class="breadcrumb-item active"><i class="bi bi-flag-fill me-1"></i>Complete</li>
                    </ol>
                </nav>

                <div class="card shadow-sm">
                    <div class="card-header bg-success text-white">
                        <h4 class="mb-0"><i class="bi bi-clipboard-check me-2"></i>Review & Submit</h4>
                    </div>
                    <div class="card-body">
                        <p class="text-muted mb-4">Please review your information before submitting your seller application.</p>

                        @if (!string.IsNullOrEmpty(Model.ErrorMessage))
                        {
                            <div class="alert alert-danger" role="alert">
                                <i class="bi bi-exclamation-triangle-fill me-2"></i>@Model.ErrorMessage
                            </div>
                        }

                        <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

                        <!-- Store Profile Summary -->
                        <div class="card mb-3">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span><i class="bi bi-shop me-2"></i>Store Profile</span>
                                <a asp-page="StoreProfile" class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-pencil"></i> Edit
                                </a>
                            </div>
                            <div class="card-body">
                                <dl class="row mb-0">
                                    <dt class="col-sm-4">Store Name</dt>
                                    <dd class="col-sm-8">@Model.Onboarding?.StoreName</dd>
                                    <dt class="col-sm-4">Description</dt>
                                    <dd class="col-sm-8">@(Model.Onboarding?.StoreDescription?.Length > 100 ? Model.Onboarding.StoreDescription.Substring(0, 100) + "..." : Model.Onboarding?.StoreDescription)</dd>
                                    @if (!string.IsNullOrEmpty(Model.Onboarding?.StoreLogoUrl))
                                    {
                                        <dt class="col-sm-4">Logo URL</dt>
                                        <dd class="col-sm-8 text-truncate">@Model.Onboarding.StoreLogoUrl</dd>
                                    }
                                </dl>
                            </div>
                        </div>

                        <!-- Verification Data Summary -->
                        <div class="card mb-3">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span><i class="bi bi-shield-check me-2"></i>Verification Data</span>
                                <a asp-page="VerificationData" class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-pencil"></i> Edit
                                </a>
                            </div>
                            <div class="card-body">
                                <dl class="row mb-0">
                                    <dt class="col-sm-4">Business Name</dt>
                                    <dd class="col-sm-8">@Model.Onboarding?.BusinessName</dd>
                                    <dt class="col-sm-4">Business Address</dt>
                                    <dd class="col-sm-8">@Model.Onboarding?.BusinessAddress</dd>
                                    <dt class="col-sm-4">Tax ID</dt>
                                    <dd class="col-sm-8">@Model.Onboarding?.TaxId</dd>
                                    @if (!string.IsNullOrEmpty(Model.Onboarding?.BusinessRegistrationNumber))
                                    {
                                        <dt class="col-sm-4">Registration #</dt>
                                        <dd class="col-sm-8">@Model.Onboarding.BusinessRegistrationNumber</dd>
                                    }
                                </dl>
                            </div>
                        </div>

                        <!-- Payout Basics Summary -->
                        <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span><i class="bi bi-credit-card me-2"></i>Payout Basics</span>
                                <a asp-page="PayoutBasics" class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-pencil"></i> Edit
                                </a>
                            </div>
                            <div class="card-body">
                                <dl class="row mb-0">
                                    <dt class="col-sm-4">Bank Name</dt>
                                    <dd class="col-sm-8">@Model.Onboarding?.BankName</dd>
                                    <dt class="col-sm-4">Account Holder</dt>
                                    <dd class="col-sm-8">@Model.Onboarding?.AccountHolderName</dd>
                                    <dt class="col-sm-4">Account Number</dt>
                                    <dd class="col-sm-8">
                                        @if (!string.IsNullOrEmpty(Model.Onboarding?.BankAccountNumber) && Model.Onboarding.BankAccountNumber.Length >= 4)
                                        {
                                            @:â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢@(Model.Onboarding.BankAccountNumber.Substring(Model.Onboarding.BankAccountNumber.Length - 4))
                                        }
                                        else
                                        {
                                            @:â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢
                                        }
                                    </dd>
                                    @if (!string.IsNullOrEmpty(Model.Onboarding?.BankRoutingNumber))
                                    {
                                        <dt class="col-sm-4">Routing Number</dt>
                                        <dd class="col-sm-8">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</dd>
                                    }
                                </dl>
                            </div>
                        </div>

                        <form method="post">
                            <div class="form-check mb-4">
                                <input class="form-check-input" type="checkbox" id="agreeTerms" required>
                                <label class="form-check-label" for="agreeTerms">
                                    I confirm that all the information provided is accurate and complete. I agree to the
                                    <a href="#" target="_blank">Seller Terms of Service</a> and
                                    <a href="#" target="_blank">Privacy Policy</a>.
                                </label>
                            </div>

                            <div class="d-flex justify-content-between">
                                <a asp-page="PayoutBasics" class="btn btn-outline-secondary">
                                    <i class="bi bi-arrow-left me-1"></i>Back
                                </a>
                                <button type="submit" class="btn btn-success btn-lg">
                                    <i class="bi bi-check-lg me-1"></i>Submit Application
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            }
        </div>
    </div>
</div>
